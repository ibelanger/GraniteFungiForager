<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NH Tier 1 Wild Mushroom Probability Map</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ„ New Hampshire Tier 1 Wild Mushroom Probability Map</h1>
        
        <div class="controls">
            <div class="control-group">
                <h3>Data Source</h3>
                <div id="weather-status" style="margin-top: 10px; font-size: 0.9em;">
                    <span id="status-text"></span>
                </div>
                <button class="update-btn" id="refresh-weather">Refresh Weather</button>
            </div>
            <div class="control-group">
                <h3>Manual Override</h3>
                <label for="season">Season:</label>
                <select id="season"></select>
                <button class="update-btn" id="update-map">Update Map</button>
                <div style="margin-top:10px;">
                    <input type="checkbox" id="auto-weather" checked>
                    <label for="auto-weather">Auto Weather</label>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <h3>Weather Conditions</h3>
                <div id="weather-display">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>Recent Rainfall (7 days):</span>
                        <span id="rainfall-display">Loading...</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>Soil Temperature:</span>
                        <span id="soil-temp-display">Loading...</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Air Temperature:</span>
                        <span id="air-temp-display">Loading...</span>
                    </div>
                </div>
            </div>

            <div class="control-group" id="manual-controls" style="display: none;">
                <h3>Manual Settings</h3>
                <label>Recent Rainfall - Past 7-10 Days (inches):</label>
                <input type="range" id="rainfall" min="0" max="5" value="2" step="0.1">
                <span id="rainfall-value">2.0</span>
                <label>Soil Temperature (Â°F):</label>
                <input type="range" id="soil-temp" min="40" max="80" value="65" step="1">
                <span id="soil-temp-value">65Â°F</span>
                <label>Air Temperature (Â°F):</label>
                <input type="range" id="air-temp" min="40" max="90" value="70" step="1">
                <span id="air-temp-value">70Â°F</span>
            </div>
            
            <div class="control-group">
                <h3>Target Species</h3>
                <select id="species">
                    <option value="all">All Tier 1 Species</option>
                    <option value="beefsteak">Beefsteak Polypore (Fistulina hepatica)</option>
                    <option value="blacktrumpets">Black Trumpet (Craterellus fallax, C. cornucopioides)</option>
                    <option value="blewit">Blewit (Lepista nuda)</option>
                    <option value="cauliflower">Cauliflower (Sparassis spathulata, S. americana)</option>
                    <option value="goldenchanterelle">Chanterelles (Cantharellus spp.)</option>
                    <option value="milkcaps">Corrugated-cap, Orange & Tawny Milky (Lactifluus spp.)</option>
                    <option value="hedgehog">Hedgehog Mushrooms (Hydnum spp.)</option>
                    <option value="jellyear">Jelly Ear (Auricularia americana)</option>
                    <option value="kingbolete">King Bolete Group (Boletus edulis group)</option>
                    <option value="hericium">Lion's Mane, Bear's Head, Coral Tooth (Hericium spp.)</option>
                    <option value="lobster">Lobster Mushroom (Hypomyces lactifluorum)</option>
                    <option value="maitake">Maitake / Hen of the Woods (Grifola frondosa)</option>
                    <option value="matsutake">Matsutake (Tricholoma magnivelare)</option>
                    <option value="morels">Morels (Morchella spp.)</option>
                    <option value="oyster">Oyster Mushrooms (Pleurotus spp.)</option>
                    <option value="russula">Green Quilted Russula (Russula spp.)</option>
                    <option value="shaggymane">Shaggy Mane (Coprinus comatus)</option>
                    <option value="trumpetchanterelle">Trumpet Chanterelles (Craterellus spp.)</option>
                    <option value="winecap">Wine Cap / King Stropharia (Stropharia rugosoannulata)</option>
                </select>
            </div>
        </div>
        
        <div class="control-group" id="species-info-card" style="display: none;">
            <h3 id="species-card-title">ğŸ„ Species Information</h3>
            <div id="species-basic-info"></div>
            <div id="species-habitat"></div>
            <div id="species-timing"></div>
            <div id="species-identification"></div>
        </div>
        
        <div class="control-group">
            <h3>Public Land Recommendations</h3>
            <div id="rec-text" style="margin-top: 10px; font-size: 0.9em; max-height: 200px; overflow-y: auto;"></div>
        </div>
        
        <div class="legend">
           <div style="text-align:center; width:100%; margin-bottom:10px; font-size:1em; color:#fff;">
                <strong>How to interpret the map:</strong><br>
                <span style="font-size:0.95em; color:#e0e0e0;">
                    Probability % reflects the likelihood of finding the selected mushroom in suitable habitat, given current weather and season.
                </span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #228B22;"></div>
                <span><strong>Very High (80-100%)</strong>: Mushrooms are likely abundant and easy to find in prime habitat, especially after rain.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #90EE90;"></div>
                <span><strong>High (60-80%)</strong>: Good chance in the right spots, especially after recent rain.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FFD700;"></div>
                <span><strong>Moderate (40-60%)</strong>: Possible, but patchy or dependent on microhabitat.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FFA500;"></div>
                <span><strong>Low (20-40%)</strong>: Unlikely except in the best spots or after ideal conditions.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FF6B6B;"></div>
                <span><strong>Very Low (0-20%)</strong>: Rare, only in exceptional microhabitats or not in season.</span>
            </div>
        </div>
        
        <div class="map-container">
            <svg id="nh-map" viewBox="0 0 400 500">
                <!-- NH State Outline - Simplified Rectangle with Northern Extension -->
                <rect x="50" y="20" width="300" height="460" fill="none" stroke="#fff" stroke-width="2" rx="10"/>
                <!-- Northern panhandle extension -->
                <rect x="120" y="0" width="160" height="40" fill="none" stroke="#fff" stroke-width="2" rx="5"/>
                
                <!-- County Grid - Clean Rectangles -->
                
                <!-- Top Row: Coos County (Northern Panhandle) -->
                <g id="coos" class="region" data-region="Coos County">
                    <rect x="120" y="0" width="160" height="80" class="zone" data-probability="90" rx="5"/>
                    <text x="200" y="45" fill="white" font-size="14" font-weight="bold" text-anchor="middle">Coos</text>
                </g>
                
                <!-- Second Row: Grafton (West) and Carroll (East) -->
                <g id="grafton" class="region" data-region="Grafton County">
                    <rect x="50" y="80" width="200" height="100" class="zone" data-probability="85" rx="5"/>
                    <text x="150" y="135" fill="white" font-size="14" font-weight="bold" text-anchor="middle">Grafton</text>
                </g>
                
                <g id="carroll" class="region" data-region="Carroll County">
                    <rect x="250" y="80" width="100" height="100" class="zone" data-probability="82" rx="5"/>
                    <text x="300" y="135" fill="white" font-size="12" font-weight="bold" text-anchor="middle">Carroll</text>
                </g>
                
                <!-- Third Row: Sullivan (West), Merrimack (Center), Belknap (East) -->
                <g id="sullivan" class="region" data-region="Sullivan County">
                    <rect x="50" y="180" width="100" height="120" class="zone" data-probability="78" rx="5"/>
                    <text x="100" y="245" fill="white" font-size="12" font-weight="bold" text-anchor="middle">Sullivan</text>
                </g>
                
                <g id="merrimack" class="region" data-region="Merrimack County">
                    <rect x="150" y="180" width="120" height="120" class="zone" data-probability="72" rx="5"/>
                    <text x="210" y="245" fill="white" font-size="12" font-weight="bold" text-anchor="middle">Merrimack</text>
                </g>
                
                <g id="belknap" class="region" data-region="Belknap County">
                    <rect x="270" y="180" width="80" height="120" class="zone" data-probability="70" rx="5"/>
                    <text x="310" y="245" fill="white" font-size="11" font-weight="bold" text-anchor="middle">Belknap</text>
                </g>
                
                <!-- Fourth Row: Cheshire (West), Hillsborough (Center), Strafford (East) -->
                <g id="cheshire" class="region" data-region="Cheshire County">
                    <rect x="50" y="300" width="100" height="120" class="zone" data-probability="80" rx="5"/>
                    <text x="100" y="365" fill="white" font-size="12" font-weight="bold" text-anchor="middle">Cheshire</text>
                </g>
                
                <g id="hillsborough" class="region" data-region="Hillsborough County">
                    <rect x="150" y="300" width="120" height="120" class="zone" data-probability="68" rx="5"/>
                    <text x="210" y="365" fill="white" font-size="11" font-weight="bold" text-anchor="middle">Hillsborough</text>
                </g>
                
                <g id="strafford" class="region" data-region="Strafford County">
                    <rect x="270" y="300" width="80" height="120" class="zone" data-probability="65" rx="5"/>
                    <text x="310" y="365" fill="white" font-size="11" font-weight="bold" text-anchor="middle">Strafford</text>
                </g>
                
                <!-- Bottom Row: Rockingham County (Southeast) -->
                <g id="rockingham" class="region" data-region="Rockingham County">
                    <rect x="190" y="420" width="160" height="60" class="zone" data-probability="60" rx="5"/>
                    <text x="270" y="455" fill="white" font-size="12" font-weight="bold" text-anchor="middle">Rockingham</text>
                </g>
                
                <!-- Geographic Feature Icons -->
                <g class="geographic-features">
                    <!-- White Mountains in Carroll/Grafton -->
                    <text x="220" y="110" font-size="20">ğŸ”ï¸</text>
                    <text x="280" y="110" font-size="20">ğŸ”ï¸</text>
                    
                    <!-- Lakes in Belknap -->
                    <text x="290" y="220" font-size="16">ğŸï¸</text>
                    <text x="320" y="240" font-size="16">ğŸï¸</text>
                    
                    <!-- Forests distributed across counties -->
                    <text x="80" y="110" font-size="16">ğŸŒ²</text>
                    <text x="120" y="130" font-size="16">ğŸŒ²</text>
                    <text x="180" y="110" font-size="16">ğŸŒ²</text>
                    <text x="160" y="40" font-size="16">ğŸŒ²</text>
                    <text x="240" y="40" font-size="16">ğŸŒ²</text>
                    <text x="70" y="220" font-size="16">ğŸŒ²</text>
                    <text x="130" y="210" font-size="16">ğŸŒ²</text>
                    <text x="190" y="220" font-size="16">ğŸŒ²</text>
                    <text x="240" y="210" font-size="16">ğŸŒ²</text>
                    <text x="80" y="340" font-size="16">ğŸŒ²</text>
                    <text x="130" y="330" font-size="16">ğŸŒ²</text>
                    <text x="190" y="340" font-size="16">ğŸŒ²</text>
                    <text x="240" y="330" font-size="16">ğŸŒ²</text>
                    <text x="290" y="340" font-size="16">ğŸŒ²</text>
                    
                    <!-- Seacoast -->
                    <text x="330" y="450" font-size="16">ğŸŒŠ</text>
                    <text x="320" y="470" font-size="16">ğŸŒŠ</text>
                </g>
            </svg>
        </div>
        
        <div class="disclaimer">
            <strong>âš ï¸ Important Disclaimer:</strong> This map provides probability estimates based on ecological factors. "Recent rainfall" refers to precipitation in the past 7-10 days, which is the typical timeframe for mushroom fruiting response. Always verify mushroom identification with experts before consumption. Only licensed foragers can legally sell wild mushrooms in NH. Never eat any mushroom unless you are 100% certain of its identification.
        </div>
    </div>
    <script type="module" src="js/main.js"></script>
</body>
</html>
